window.Modernizr=function(a,b,c){function d(a){k.cssText=a}function e(a,b){return typeof a===b}var f,g,h={},i=b.documentElement,j=b.createElement("modernizr"),k=j.style,l={},m=[],n=m.slice,o={}.hasOwnProperty;g=e(o,"undefined")||e(o.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return o.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=n.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(n.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(n.call(arguments)))};return d});for(var p in l)g(l,p)&&(f=p.toLowerCase(),h[f]=l[p](),m.push((h[f]?"":"no-")+f));return h.addTest=function(a,b){if("object"==typeof a)for(var d in a)g(a,d)&&h.addTest(d,a[d]);else{if(a=a.toLowerCase(),h[a]!==c)return h;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(i.className+=" "+(b?"":"no-")+a),h[a]=b}return h},d(""),j=null,h._version="2.8.3",h}(0,this.document),Modernizr.addTest("adownload","download"in document.createElement("a")),Modernizr.addTest("filereader",function(){return!!(window.File&&window.FileList&&window.FileReader)}),function(){"use strict";window.JSFile=window.JSFile||{}}(),window.JSFile=window.JSFile||{},function(a){"use strict";a.supported_file_types={txt:"text/plain",csv:"text/csv",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xls:"application/vnd.ms-excel",ods:"application/vnd.oasis.opendocument.spreadsheet"}}(window.JSFile),window.JSFile=window.JSFile||{},function(a){"use strict";var b=function(){var b=this;this.MESSAGE_UNSUPPORTED_FILE_MIMETYPE="FileUtil: file mimetype is not supported",this.MESSAGE_UNSUPPORTED_FILE_EXTENSION="FileUtil: file extension is not supported",this.MESSAGE_FILE_NAME_IS_REQUIRED="FileUtil: file_name is required",this.MESSAGE_FILE_EXTENSION_MISMATCH="FileUtil: the extension contained in the file_name argument does not match the file_extension argument",this.MESSAGE_FILE_EXTENSION_IS_REQUIRED="FileUtil: an file extension must be provided, either as part of the filename or as the file_extension argument";var c={sheet:{columns:[],data:[],headers:[],name:[]},headers:{colspan:["cols"],rowspan:["rows"],value:["display_name","name","label"]},columns:{type:[]}};this.transformData=function(a){return _.isArray(a)||(a=[a]),_.forEach(a,function(b,c){a[c]=d(b,c),_.isArray(b.headers[0])||(a[c].headers=[b.headers]),_.forEach(a[c].headers,function(b,d){_.forEach(b,function(b,f){a[c].headers[d][f]=e(b)})})}),a},this.transformFilenameAndExtension=function(b,c){if(_.isUndefined(b)||_.isNull(b)||""===b)throw new Error(this.MESSAGE_FILE_NAME_IS_REQUIRED);if(!_.isUndefined(c)&&!_.includes(_.keys(a.supported_file_types),c))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_EXTENSION);var d=/[^.]+$/.exec(b);if(_.includes(_.keys(a.supported_file_types),d[0])){if(!_.isUndefined(c)&&d[0]!==c)throw new Error(this.MESSAGE_FILE_EXTENSION_MISMATCH);b=/(.*)\.[^.]+$/.exec(b)[1],c=d[0]}else if(_.isUndefined(c))throw new Error(this.MESSAGE_FILE_EXTENSION_IS_REQUIRED);return b+="."+c,{filename:b,file_extension:c}},this.nextLetter=function(a,b){return _.isUndefined(b)&&(b=1),a.replace(/([a-zA-Z])[^a-zA-Z]*$/,function(a){var c=a.charCodeAt(0);switch(c){case 90:return"A";case 122:return"a";default:return String.fromCharCode(c+b)}})},this.letterToNumber=function(a){return a===a.toLowerCase()?a.charCodeAt(0)-96:a.charCodeAt(0)-64},this.numberToLetter=function(a,b){return b?String.fromCharCode(a+64):String.fromCharCode(a+96)},this.transformWorksheetHeadersArray=function(a){var b=_.cloneDeep(a);return _.forEach(a,function(a,c){var d=0;_.forEach(a,function(a,e){if(a.rowspan>1)for(var f=1;f<a.rowspan;f++){var g=c+f;if(!_.has(b,g)){b[g]=[];for(var h=0;h<e+d;h++)b[g].push({})}b[g].splice(e+d,0,{})}if(a.colspan>1){for(var i=1;i<a.colspan;i++){var j=e+d+i;b[c].splice(j,0,{})}d+=a.colspan-1}})}),b},this.convertWorksheetHeadersArrayToObject=function(a){var c={};return _.forEach(a,function(a,d){var e="A";_.forEach(a,function(a){_.has(a,"value")&&(c[e+(d+1)]=a.value),e=b.nextColumn(e)})}),c},this.calculateWorksheetHeadersMerges=function(a){var b=[];return _.forEach(a,function(a,c){_.forEach(a,function(a,d){(_.has(a,"rowspan")&&a.rowspan>1||_.has(a,"colspan")&&a.colspan>1)&&b.push({s:{c:d,r:c},e:{c:d+(a.colspan-1),r:c+(a.rowspan-1)}})})}),b},this.getFileExtension=function(b,c){if(!_.includes(_.values(a.supported_file_types),c))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_MIMETYPE);var d=_.findKey(a.supported_file_types,function(a){return a===c});return-1!==navigator.platform.indexOf("Win")&&"csv"===b&&"xls"===d?b:d},this.getFileMimeType=function(b){if(!_.includes(_.keys(a.supported_file_types),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_EXTENSION);return a.supported_file_types[b]};var d=function(a,b){var d=_.keys(a);return _.has(a,"columns")&&!_.isUndefined(a.columns)||(a.columns=f(a,d,c.sheet.columns,[])),_.has(a,"data")&&!_.isUndefined(a.data)||(a.data=f(a,d,c.sheet.data,[])),_.has(a,"headers")&&!_.isUndefined(a.headers)||(a.headers=f(a,d,c.sheet.headers,[])),_.has(a,"name")&&!_.isUndefined(a.name)||(a.name=f(a,d,c.sheet.name,"sheet"+(b+1))),{columns:a.columns,data:a.data,headers:a.headers,name:a.name}},e=function(a){var b={},d=[];return _.forEach(a,function(a,c){if(!_.isObject(a)){var e=_.snakeCase(c);b[e]=a,d.push(e)}}),_.has(b,"value")||(b.value=f(b,d,c.headers.value)),_.has(b,"rowspan")||(b.rowspan=parseInt(f(b,d,c.headers.rowspan,1))),_.has(b,"colspan")||(b.colspan=parseInt(f(b,d,c.headers.colspan,1))),{value:b.value,rowspan:b.rowspan,colspan:b.colspan}},f=function(a,b,c,d){var e=_.isUndefined(d)?"":d;return _.forEach(c,function(c){if(_.includes(b,c))return e=a[c],!1}),e};this.nextColumn=function(a){var b;a=a.toUpperCase();var c="";if(a.length>2&&console.warn("Only 702 columns are supported"),"Z"===a[a.length-1]){b=a.charCodeAt(0);var d="A";b<90?c=String.fromCharCode(b+1)+d:(d+="A",c=d)}else{b=a[a.length-1].charCodeAt(0);c=a.slice(0,-1)+String.fromCharCode(b+1)}return c}};a.FileUtil=new b}(window.JSFile),window.JSFile=window.JSFile||{},function(a){"use strict";a.Workbook=function(b){if(_.isUndefined(b)||_.isNull(b))throw new Error("data param is required for Workbook model");var c=this;this.SheetNames=[],this.Sheets={},b=a.FileUtil.transformData(b),_.forEach(b,function(b){c.SheetNames.push(b.name),c.Sheets[b.name]=new a.Worksheet(b)})}}(window.JSFile),window.JSFile=window.JSFile||{},function(a){"use strict";a.Worksheet=function(b){if(_.isUndefined(b)||_.isNull(b))throw new Error("data param is required for Worksheet model");var c=this;this["!merges"]=[],this["!ref"]=[];var d=a.FileUtil.transformWorksheetHeadersArray(b.headers),e=[];_.forEach(d,function(a){e.push(a.length)}),this["!merges"]=a.FileUtil.calculateWorksheetHeadersMerges(d);var f=d.length+1;d=a.FileUtil.convertWorksheetHeadersArrayToObject(d),_.forEach(d,function(b,d){c[d]=new a.WorksheetCell({type:"s",value:b})}),_.forEach(b.data,function(b){var d="A",g=0;_.forEach(b,function(b){c[d+f]=new a.WorksheetCell({type:"s",value:b.value}),d=a.FileUtil.nextColumn(d),g++}),e.push(g),f++});var g=_.max(e);this["!ref"]=XLSX.utils.encode_range({s:{c:0,r:0},e:{c:g-1,r:f-2}})}}(window.JSFile),window.JSFile=window.JSFile||{},function(a){"use strict";a.WorksheetCell=function(a){if(_.isUndefined(a)||_.isNull(a))throw new Error("data param is required for WorksheetCell model");if(!_.has(a,"value"))throw new Error("data.value param is required for WorksheetCell model");this.t=_.has(a,"type")?a.type:"s",this.v="",null!==a.value&&(this.v=a.value)}}(window.JSFile),function(){"use strict";if(void 0===window._)throw new Error("Please include Lodash (https://github.com/lodash/lodash)");if(void 0===window.XLSX)throw new Error("Please include js-xlsx (https://github.com/SheetJS/js-xlsx)");if(void 0===window.Blob)throw new Error("Please include blob (https://github.com/eligrey/Blob.js/)")}(),window.JSFile=window.JSFile||{},function(a){"use strict";var b=function(){var b=this;this.MESSAGE_WORKBOOK_IS_REQUIRED="FileDownloader: workbook param is required for FileDownloader.downloadWorkbook",this.MESSAGE_WORKBOOK_MODEL_IS_INVALID="FileDownloader: workbook param must be an instance of JSFile.Workbook",this.MESSAGE_FILE_NAME_IS_REQUIRED="FileDownloader: file_name is required",this.CURRENTLY_UNSUPPORTED_FILE_TYPE="FileDownloader: this file type is currently not supported.",this.UNSUPPORTED_BROWSER_FEATURE_AND_NO_FALLBACK="FileDownloader: browser does support the required feature and no fallback method was provided",this.downloadWorkbook=function(b,c,d){if(_.isUndefined(b)||_.isNull(b))throw new Error(this.MESSAGE_WORKBOOK_IS_REQUIRED);if(!(b instanceof a.Workbook))throw new Error(this.MESSAGE_WORKBOOK_MODEL_IS_INVALID);if(_.isUndefined(c)||_.isNull(c)||""===c)throw new Error(this.MESSAGE_FILE_NAME_IS_REQUIRED);var e=a.FileUtil.transformFilenameAndExtension(c,d),f=this.create_file_handlers[e.file_extension](b,e.file_extension),g=a.FileUtil.getFileMimeType(e.file_extension);i(f,e.filename,g)};var c=function(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!==a.length;++d)c[d]=255&a.charCodeAt(d);return b},d=function(a,b){return XLSX.write(a,{bookType:b,bookSST:!1,type:"binary"})},e=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},f=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},g=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},h=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},i=function(a,d,e){var f=c(a),g=new Blob([f],{type:e});if(window.navigator.msSaveBlob)return window.navigator.msSaveBlob(g,d);if(!Modernizr.adownload||!window.saveAs){if(_.isUndefined(b.initiateFileDownloadFallback))throw new Error(b.UNSUPPORTED_BROWSER_FEATURE_AND_NO_FALLBACK);return b.initiateFileDownloadFallback(g,d,a)}return window.saveAs(g,d)};this.create_file_handlers={xlsx:d,ods:e,xls:f,txt:g,csv:h}};a.FileDownloader=new b}(window.JSFile),function(){"use strict";if(void 0===window._)throw new Error("Please include Lodash (https://github.com/lodash/lodash)");if(void 0===window.XLSX)throw new Error("Please include js-xlsx (https://github.com/SheetJS/js-xlsx)")}(),window.JSFile=window.JSFile||{},function(a){"use strict";var b=function(){this.MESSAGE_FILE_DATA_IS_REQUIRED="FileReader: file_data param is required",this.MESSAGE_FILE_TYPE_IS_REQUIRED="FileReader: file_type param is required",this.MESSAGE_UNSUPPORTED_FILE_TYPE="FileReader: file type is not supported",this.MESSAGE_FILE_READ_ERROR="FileReader: could not read file. Either file data is invalid, or file_type does not match file_data.",this.getWorksheetNames=function(a,b){if(_.isUndefined(a)||_.isNull(a))throw new Error(this.MESSAGE_FILE_DATA_IS_REQUIRED);if(_.isUndefined(b)||_.isNull(b))throw new Error(this.MESSAGE_FILE_TYPE_IS_REQUIRED);if(b=b.toLowerCase(),!_.includes(_.keys(this.get_worksheet_names_handlers),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_TYPE);return this.get_worksheet_names_handlers[b](a)},this.fileToArray=function(a,b,c,d){if(_.isUndefined(a)||_.isNull(a))throw new Error(this.MESSAGE_FILE_DATA_IS_REQUIRED);if(_.isUndefined(b)||_.isNull(b))throw new Error(this.MESSAGE_FILE_TYPE_IS_REQUIRED);if(d=_.isUndefined(d)?"row":d.toLowerCase(),b=b.toLowerCase(),!_.includes(_.keys(this.file_to_array_handlers),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_TYPE);return this.file_to_array_handlers[b](a,c,d)};var a=function(a,b){var c=a.split(/\n/);_.forEach(c,function(a,b,c){c[b]=a.split(/,/)});if(_.isArray(b)?!_.isUndefined(b[0])&&!0===b[0]:!0===b){var d=[],e=c[0];return _.forEach(c,function(a){var b={};_.forEach(a,function(a,c){b[e[c]]=a}),d.push(b)}),[{name:"Sheet1",headings:d.shift(),data:d}]}return[{name:"Sheet1",headings:[],data:c}]},b=function(a,b,c){var e=[];try{var f=XLSX.read(a,{type:"binary"});e=d(f,b,c)}catch(a){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return e},c=function(a,b,c){if(void 0===window.XLS)throw new Error("Please include js-xls (https://github.com/SheetJS/js-xls)");var e=[];try{var f=window.XLS.read(a,{type:"binary"});e=d(f,b,c)}catch(a){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return e},d=function(a,b){var c=[],d=0;return _.forEach(a.Sheets,function(a,e){var f;f=_.isArray(b)?!_.isUndefined(b[d])&&!0===b[d]:!0===b;var g=[],h={},i=f?{}:[],j=0;_.forEach(a,function(a,b){if(!_.isUndefined(a.v)){var c=b.match(/([A-Za-z]+)([0-9]+)/),d=c[1],e=parseInt(c[2]);f&&1===e&&(h[d]=a.v),(!f||e>1)&&(e>j&&(i=f?{}:[],g.push(i)),f?i[h[d]]=a.v:i.push(a.v)),j=e}}),c.push({name:e,headings:h,data:g}),d++}),c},e=function(a){var b=[];try{var c=XLSX.read(a,{type:"binary"});_.forEach(c.Sheets,function(a,c){b.push(c)})}catch(a){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return b},f=function(a){var b=[];try{var c=XLS.read(a,{type:"binary"});_.forEach(c.Sheets,function(a,c){b.push(c)})}catch(a){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return b};this.file_to_array_handlers={xlsx:b,ods:b,xls:c,txt:a,csv:a},this.get_worksheet_names_handlers={xlsx:e,ods:e,xls:f}};a.FileReader=new b}(window.JSFile);
//# sourceMappingURL=js-file.min.js.map