if(window.Modernizr=function(a,b,c){function d(a){n.cssText=a}function e(a,b){return typeof a===b}var f,g,h,i="2.8.3",j={},k=b.documentElement,l="modernizr",m=b.createElement(l),n=m.style,o=({}.toString,{}),p=[],q=p.slice,r={}.hasOwnProperty;h=e(r,"undefined")||e(r.call,"undefined")?function(a,b){return b in a&&e(a.constructor.prototype[b],"undefined")}:function(a,b){return r.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=q.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(q.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(q.call(arguments)))};return d});for(var s in o)h(o,s)&&(g=s.toLowerCase(),j[g]=o[s](),p.push((j[g]?"":"no-")+g));return j.addTest=function(a,b){if("object"==typeof a)for(var d in a)h(a,d)&&j.addTest(d,a[d]);else{if(a=a.toLowerCase(),j[a]!==c)return j;b="function"==typeof b?b():b,"undefined"!=typeof enableClasses&&enableClasses&&(k.className+=" "+(b?"":"no-")+a),j[a]=b}return j},d(""),m=f=null,j._version=i,j}(this,this.document),Modernizr.addTest("adownload","download"in document.createElement("a")),Modernizr.addTest("filereader",function(){return!!(window.File&&window.FileList&&window.FileReader)}),window.JSFile=window.JSFile||{},window.JSFile=window.JSFile||{},function(a){a.supported_file_types={txt:"text/plain",csv:"text/csv",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xls:"application/vnd.ms-excel",ods:"application/vnd.oasis.opendocument.spreadsheet"}}(window.JSFile),window.JSFile=window.JSFile||{},function(a){var b=function(){var b=this,c="FileUtil: ";this.MESSAGE_UNSUPPORTED_FILE_MIMETYPE=c+"file mimetype is not supported",this.MESSAGE_UNSUPPORTED_FILE_EXTENSION=c+"file extension is not supported",this.MESSAGE_FILE_NAME_IS_REQUIRED=c+"file_name is required",this.MESSAGE_FILE_EXTENSION_MISMATCH=c+"the extension contained in the file_name argument does not match the file_extension argument",this.MESSAGE_FILE_EXTENSION_IS_REQUIRED=c+"an file extension must be provided, either as part of the filename or as the file_extension argument";var d={sheet:{columns:[],data:[],headers:[],name:[]},headers:{colspan:["cols"],rowspan:["rows"],value:["display_name","name","label"]},columns:{type:[]}};this.transformData=function(a){return _.isArray(a)||(a=[a]),_.forEach(a,function(b,c){a[c]=e(b,c),_.isArray(b.headers[0])||(a[c].headers=[b.headers]),_.forEach(a[c].headers,function(b,d){_.forEach(b,function(b,e){a[c].headers[d][e]=f(b)})})}),a},this.transformFilenameAndExtension=function(b,c){if(_.isUndefined(b)||_.isNull(b)||""===b)throw new Error(this.MESSAGE_FILE_NAME_IS_REQUIRED);if(!_.isUndefined(c)&&!_.includes(_.keys(a.supported_file_types),c))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_EXTENSION);var d=/[^.]+$/.exec(b);if(_.includes(_.keys(a.supported_file_types),d[0])){if(!_.isUndefined(c)&&d[0]!==c)throw new Error(this.MESSAGE_FILE_EXTENSION_MISMATCH);b=/(.*)\.[^.]+$/.exec(b)[1],c=d[0]}else if(_.isUndefined(c))throw new Error(this.MESSAGE_FILE_EXTENSION_IS_REQUIRED);return b+="."+c,{filename:b,file_extension:c}},this.nextLetter=function(a,b){return _.isUndefined(b)&&(b=1),a.replace(/([a-zA-Z])[^a-zA-Z]*$/,function(a){var c=a.charCodeAt(0);switch(c){case 90:return"A";case 122:return"a";default:return String.fromCharCode(c+b)}})},this.letterToNumber=function(a){return a===a.toLowerCase()?a.charCodeAt(0)-96:a.charCodeAt(0)-64},this.numberToLetter=function(a,b){return String.fromCharCode(b?a+64:a+96)},this.transformWorksheetHeadersArray=function(a){return _.forEach(a,function(b,c){_.forEach(b,function(b,d){if(b.rowspan>1)for(var e=1;e<b.rowspan;e++){var f=c+e;if(!_.has(a,f)){a[f]=[];for(var g=0;d>g;g++)a[f].push({})}a[f].splice(d,0,{})}if(b.colspan>1)for(var h=1;h<b.colspan;h++){var i=d+h;a[c].splice(i,0,{})}})}),a},this.convertWorksheetHeadersArrayToObject=function(a){var c={};return _.forEach(a,function(a,d){var e="A";_.forEach(a,function(a){_.has(a,"value")&&(c[e+(d+1)]=a.value),e=b.nextLetter(e)})}),c},this.calculateWorksheetHeadersMerges=function(a){var b=[];return _.forEach(a,function(a,c){_.forEach(a,function(a,d){(_.has(a,"rowspan")&&a.rowspan>1||_.has(a,"colspan")&&a.colspan>1)&&b.push({s:{c:d,r:c},e:{c:d+(a.colspan-1),r:c+(a.rowspan-1)}})})}),b},this.getFileExtension=function(b){if(!_.includes(_.values(a.supported_file_types),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_MIMETYPE);return _.findKey(a.supported_file_types,function(a){return a===b})},this.getFileMimeType=function(b){if(!_.includes(_.keys(a.supported_file_types),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_EXTENSION);return a.supported_file_types[b]};var e=function(a,b){var c=_.keys(a);return(!_.has(a,"columns")||_.isUndefined(a.columns))&&(a.columns=g(a,c,d.sheet.columns,[])),(!_.has(a,"data")||_.isUndefined(a.data))&&(a.data=g(a,c,d.sheet.data,[])),(!_.has(a,"headers")||_.isUndefined(a.headers))&&(a.headers=g(a,c,d.sheet.headers,[])),(!_.has(a,"name")||_.isUndefined(a.name))&&(a.name=g(a,c,d.sheet.name,"sheet"+(b+1))),{columns:a.columns,data:a.data,headers:a.headers,name:a.name}},f=function(a){var b={},c=[];return _.forEach(a,function(a,d){if(!_.isObject(a)){var d=_.snakeCase(d);b[d]=a,c.push(d)}}),_.has(b,"value")||(b.value=g(b,c,d.headers.value)),_.has(b,"rowspan")||(b.rowspan=parseInt(g(b,c,d.headers.rowspan,1))),_.has(b,"colspan")||(b.colspan=parseInt(g(b,c,d.headers.colspan,1))),{value:b.value,rowspan:b.rowspan,colspan:b.colspan}},g=function(a,b,c,d){var e=_.isUndefined(d)?"":d;return _.forEach(c,function(c){return _.includes(b,c)?(e=a[c],!1):void 0}),e}};a.FileUtil=new b}(window.JSFile),window.JSFile=window.JSFile||{},function(a){a.Workbook=function(b){var c="data param is required for Workbook model";if(_.isUndefined(b)||_.isNull(b))throw new Error(c);var d=this;this.SheetNames=[],this.Sheets={},b=a.FileUtil.transformData(b),_.forEach(b,function(b){d.SheetNames.push(b.name),d.Sheets[b.name]=new a.Worksheet(b)})}}(window.JSFile),window.JSFile=window.JSFile||{},function(a){a.Worksheet=function(b){var c="data param is required for Worksheet model";if(_.isUndefined(b)||_.isNull(b))throw new Error(c);var d=this;this["!merges"]=[],this["!ref"]=[];var e=a.FileUtil.transformWorksheetHeadersArray(b.headers),f=[];_.forEach(e,function(a){f.push(a.length)}),this["!merges"]=a.FileUtil.calculateWorksheetHeadersMerges(e);var g=e.length+1;e=a.FileUtil.convertWorksheetHeadersArrayToObject(e),_.forEach(e,function(b,c){d[c]=new a.WorksheetCell({type:"s",value:b})}),_.forEach(b.data,function(b){var c="A",e=0;_.forEach(b,function(b){d[c+g]=new a.WorksheetCell({type:"s",value:b.value}),c=a.FileUtil.nextLetter(c),e++}),f.push(e),g++});var h=_.max(f);this["!ref"]=XLSX.utils.encode_range({s:{c:0,r:0},e:{c:h-1,r:g-2}})}}(window.JSFile),window.JSFile=window.JSFile||{},function(a){a.WorksheetCell=function(a){var b="data param is required for WorksheetCell model",c="data.value param is required for WorksheetCell model";if(_.isUndefined(a)||_.isNull(a))throw new Error(b);if(!_.has(a,"value"))throw new Error(c);this.t=_.has(a,"type")?a.type:"s",this.v=a.value}}(window.JSFile),"undefined"==typeof window._)throw new Error("Please include Lodash (https://github.com/lodash/lodash)");if("undefined"==typeof window.XLSX)throw new Error("Please include js-xlsx (https://github.com/SheetJS/js-xlsx)");if("undefined"==typeof window.Blob)throw new Error("Please include blob (https://github.com/eligrey/Blob.js/)");if("undefined"==typeof window.saveAs)throw new Error("Please include file-saver (https://github.com/eligrey/FileSaver.js/)");if(window.JSFile=window.JSFile||{},function(a){var b=function(){var b=this,c="FileDownloader: ";this.MESSAGE_WORKBOOK_IS_REQUIRED=c+"workbook param is required for FileDownloader.downloadWorkbook",this.MESSAGE_WORKBOOK_MODEL_IS_INVALID=c+"workbook param must be an instance of JSFile.Workbook",this.MESSAGE_FILE_NAME_IS_REQUIRED=c+"file_name is required",this.CURRENTLY_UNSUPPORTED_FILE_TYPE=c+"this file type is currently not supported.",this.UNSUPPORTED_BROWSER_FEATURE_AND_NO_FALLBACK=c+"browser does support the required feature and no fallback method was provided",this.downloadWorkbook=function(b,c,d){if(_.isUndefined(b)||_.isNull(b))throw new Error(this.MESSAGE_WORKBOOK_IS_REQUIRED);if(!(b instanceof a.Workbook))throw new Error(this.MESSAGE_WORKBOOK_MODEL_IS_INVALID);if(_.isUndefined(c)||_.isNull(c)||""===c)throw new Error(this.MESSAGE_FILE_NAME_IS_REQUIRED);var e=a.FileUtil.transformFilenameAndExtension(c,d),f=this.create_file_handlers[e.file_extension](b,e.file_extension),g=a.FileUtil.getFileMimeType(e.file_extension);j(f,e.filename,g)};var d=function(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b},e=function(a,b){var c=XLSX.write(a,{bookType:b,bookSST:!1,type:"binary"});return d(c)},f=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},g=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},h=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},i=function(){throw new Error(this.CURRENTLY_UNSUPPORTED_FILE_TYPE)},j=function(a,c,d){if(window.navigator.msSaveBlob){var e=new Blob(["\ufeff",a],{type:d});return window.navigator.msSaveBlob(e,c)}var e=new Blob([a],{type:d});if(!Modernizr.adownload){if(_.isUndefined(b.initiateFileDownloadFallback))throw new Error(b.UNSUPPORTED_BROWSER_FEATURE_AND_NO_FALLBACK);return b.initiateFileDownloadFallback(e,c)}return window.saveAs(e,c)};this.create_file_handlers={xlsx:e,ods:f,xls:g,txt:h,csv:i}};a.FileDownloader=new b}(window.JSFile),"undefined"==typeof window._)throw new Error("Please include Lodash (https://github.com/lodash/lodash)");if("undefined"==typeof window.XLSX)throw new Error("Please include js-xlsx (https://github.com/SheetJS/js-xlsx)");window.JSFile=window.JSFile||{},function(a){var b=function(){var a="FileReader: ";this.MESSAGE_FILE_DATA_IS_REQUIRED=a+"file_data param is required",this.MESSAGE_FILE_TYPE_IS_REQUIRED=a+"file_type param is required",this.MESSAGE_UNSUPPORTED_FILE_TYPE=a+"file type is not supported",this.MESSAGE_FILE_READ_ERROR=a+"could not read file. Either file data is invalid, or file_type does not match file_data.",this.getWorksheetNames=function(a,b){if(_.isUndefined(a)||_.isNull(a))throw new Error(this.MESSAGE_FILE_DATA_IS_REQUIRED);if(_.isUndefined(b)||_.isNull(b))throw new Error(this.MESSAGE_FILE_TYPE_IS_REQUIRED);if(b=b.toLowerCase(),!_.includes(_.keys(this.get_worksheet_names_handlers),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_TYPE);return this.get_worksheet_names_handlers[b](a)},this.fileToArray=function(a,b,c,d){if(_.isUndefined(a)||_.isNull(a))throw new Error(this.MESSAGE_FILE_DATA_IS_REQUIRED);if(_.isUndefined(b)||_.isNull(b))throw new Error(this.MESSAGE_FILE_TYPE_IS_REQUIRED);if(d=_.isUndefined(d)?"row":d.toLowerCase(),b=b.toLowerCase(),!_.includes(_.keys(this.file_to_array_handlers),b))throw new Error(this.MESSAGE_UNSUPPORTED_FILE_TYPE);return this.file_to_array_handlers[b](a,c,d)};var b=function(a,b){var c=a.split(/\n/);_.forEach(c,function(a,b,c){c[b]=a.split(/,/)});var d;if(d=_.isArray(b)?_.isUndefined(b[0])||b[0]!==!0?!1:!0:b===!0?!0:!1){var e=[],f=c[0];return _.forEach(c,function(a){var b={};_.forEach(a,function(a,c){b[f[c]]=a}),e.push(b)}),[{name:"Sheet1",headings:e.shift(),data:e}]}return[{name:"Sheet1",headings:[],data:c}]},c=function(a,b,c){var d=[];try{var f=XLSX.read(a,{type:"binary"});d=e(f,b,c)}catch(g){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return d},d=function(a,b,c){if("undefined"==typeof window.XLS)throw new Error("Please include js-xls (https://github.com/SheetJS/js-xls)");var d=[];try{var f=window.XLS.read(a,{type:"binary"});d=e(f,b,c)}catch(g){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return d},e=function(a,b){var c=[],d=0;return _.forEach(a.Sheets,function(a,e){var f;f=_.isArray(b)?_.isUndefined(b[d])||b[d]!==!0?!1:!0:b===!0?!0:!1;var g=[],h={},i=f?{}:[],j=0;_.forEach(a,function(a,b){if(!_.isUndefined(a.v)){var c=b.match(/([A-Za-z]+)([0-9]+)/),d=c[1],e=parseInt(c[2]);f&&1===e&&(h[d]=a.v),(!f||e>1)&&(e>j&&(i=f?{}:[],g.push(i)),f?i[h[d]]=a.v:i.push(a.v)),j=e}}),c.push({name:e,headings:h,data:g}),d++}),c},f=function(a){var b=[];try{var c=XLSX.read(a,{type:"binary"});_.forEach(c.Sheets,function(a,c){b.push(c)})}catch(d){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return b},g=function(a){var b=[];try{var c=XLS.read(a,{type:"binary"});_.forEach(c.Sheets,function(a,c){b.push(c)})}catch(d){throw new Error(this.MESSAGE_FILE_READ_ERROR)}return b};this.file_to_array_handlers={xlsx:c,ods:c,xls:d,txt:b,csv:b},this.get_worksheet_names_handlers={xlsx:f,ods:f,xls:g}};a.FileReader=new b}(window.JSFile);
//# sourceMappingURL=js-file.min.js.map