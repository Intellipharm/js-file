{"version":3,"file":"js-file.min.js","sources":["../src/scripts/utils/file-util.js","../src/scripts/models/workbook-model.js","../src/scripts/models/worksheet-model.js","../src/scripts/file-downloader/file-downloader-service.js"],"names":["window","JSFile","module","FileUtil","self","this","data_alternatives","sheet","columns","data","headers","name","colspan","rowspan","value","type","transformData","_","isArray","forEach","item","index","transformSheet","item_header_rows","header_row_index","item_header_column","header_column_index","transformHeader","nextLetter","letter","increment","isUndefined","replace","arr","char","charCodeAt","String","fromCharCode","letterToNumber","toLowerCase","numberToLetter","number","uppercase","transformWorksheetHeadersArray","row","row_index","column","column_index","row_count","next_row","has","i","push","splice","column_count","next_column","convertWorksheetHeadersArrayToObject","result","calculateWorksheetHeadersMerges","s","c","r","e","keys","findAlternativeData","_data","key","isObject","snakeCase","parseInt","alternatives","default_value","alternative","includes","Workbook","isNull","Error","SheetNames","Sheets","Worksheet","letter_count","length","cell_number","t","v","cell_letter","_letter_count","highest_letter","max","XLSX","utils","encode_range","FileDownloader","convertStringToArrayBuffer","str","array_buffer","ArrayBuffer","view","Uint8Array","downloadWorkbook","workbook","file_name","endsWith","workbook_output","write","bookType","bookSST","downloadFile","rawFile","D","document","a","createElement","strMimeType","navigator","msSaveBlob","Blob","blob","URL","createObjectURL","setAttribute","encodeURIComponent","href","body","appendChild","setTimeout","click","createEvent","eventObj","initEvent","dispatchEvent","removeChild"],"mappings":"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"}