{"version":3,"file":"js-file.min.js","sources":["../src/scripts/utils/file-util.js","../src/scripts/models/workbook-model.js","../src/scripts/models/worksheet-model.js","../src/scripts/models/worksheet-cell-model.js","../src/scripts/file-downloader/file-downloader-service.js"],"names":["window","JSFile","module","FileUtil","self","this","data_alternatives","sheet","columns","data","headers","name","colspan","rowspan","value","type","transformData","_","isArray","forEach","item","index","transformSheet","item_header_rows","header_row_index","item_header_column","header_column_index","transformHeader","nextLetter","letter","increment","isUndefined","replace","arr","char","charCodeAt","String","fromCharCode","letterToNumber","toLowerCase","numberToLetter","number","uppercase","transformWorksheetHeadersArray","row","row_index","column","column_index","row_count","next_row","has","i","push","splice","column_count","next_column","convertWorksheetHeadersArrayToObject","result","calculateWorksheetHeadersMerges","s","c","r","e","keys","findAlternativeData","_data","key","isObject","snakeCase","parseInt","alternatives","default_value","alternative","includes","Workbook","MESSAGE_DATA_IS_REQUIRED","isNull","Error","SheetNames","Sheets","Worksheet","letter_count","length","cell_number","WorksheetCell","cell_letter","_letter_count","highest_letter","max","XLSX","utils","encode_range","MESSAGE_VALUE_IS_REQUIRED","t","v","FileDownloader","convertStringToArrayBuffer","str","array_buffer","ArrayBuffer","view","Uint8Array","MESSAGE_WORKBOOK_IS_REQUIRED","MESSAGE_WORKBOOK_MODEL_IS_INVALID","downloadWorkbook","workbook","file_name","endsWith","workbook_output","write","bookType","bookSST","downloadFile","rawFile","D","document","a","createElement","strMimeType","navigator","msSaveBlob","Blob","blob","URL","createObjectURL","setAttribute","encodeURIComponent","href","body","appendChild","setTimeout","click","createEvent","eventObj","initEvent","dispatchEvent","removeChild"],"mappings":"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"}